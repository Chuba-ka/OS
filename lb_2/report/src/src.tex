\section{Метод решения}

Данная программа реализует многопоточное поэлементное сложение K вещественных массивов одинаковой длины L с использованием библиотеки POSIX Threads (pthreads) и адаптивной стратегией распределения нагрузки.

Основной алгоритм:
\begin{itemize}
    \item Генерируются K массивов длиной L с случайными значениями.
    \item Задача разбивается на блоки индексов, каждый поток суммирует элементы в своём диапазоне по всем K массивам.
    \item Число одновременно активных потоков ограничено параметром \texttt{max\_threads}, заданным через аргумент командной строки.
    \item Каждый поток использует локальный буфер для промежуточных сумм, исключая гонки на этапе вычислений.
    \item Слияние результатов в общий вектор защищено мьютексом.
    \item Семафор ограничивает количество одновременно выполняющихся потоков.
\end{itemize}

Ключевые компоненты:
\begin{itemize}
    \item \texttt{ArrayManager} — хранение и генерация массивов
    \item \texttt{ParallelSummer} — ядро параллельного суммирования (разбиение, потоки, синхронизация)
\end{itemize}

Системные вызовы (POSIX):
\begin{verbatim}
pthread_create, pthread_join,
pthread_mutex_init/lock/unlock/destroy,
sem_init, sem_wait, sem_post, sem_destroy,
getpid()
\end{verbatim}

Программа использует объектно-ориентированный подход с инкапсуляцией и RAII-подобным управлением ресурсами (мьютексы и семафоры уничтожаются в деструкторе).

\section{Описание программы}

Программа реализует эффективное многопоточное сложение $K$ массивов длины $L$ с динамической адаптацией числа потоков и строгим контролем над их количеством.

\texttt{main.cpp} — точка входа:
\begin{itemize}
    \item парсит аргумент \texttt{max\_threads},
    \item создаёт объект \texttt{ArrayManager}, заполняет массивы случайными числами,
    \item выводит PID процесса для мониторинга потоков (\texttt{ps -T -p <pid>}),
    \item запускает \texttt{ParallelSummer},
    \item выводит первые 10 элементов результата.
\end{itemize}

\texttt{ArrayManager} (\texttt{ArrayManager.h/.cpp}) —
\begin{itemize}
    \item инкапсулирует $K \times L$ массивов в \texttt{std::vector<std::vector<double>>},
    \item реализует равномерное заполнение случайными значениями.
\end{itemize}

\texttt{ParallelSummer} (\texttt{ParallelSummer.h/.cpp}) —
\begin{itemize}
    \item хранит ссылку на входные данные и вектор результата,
    \item содержит \texttt{pthread\_mutex\_t} и \texttt{sem\_t},
    \item динамически вычисляет число потоков и размеры блоков,
    \item создаёт потоки через \texttt{pthread\_create},
    \item каждый поток выполняет функцию \texttt{sumRange} с локальными суммами,
    \item обеспечивает потокобезопасную агрегацию и освобождение ресурсов.
\end{itemize}

Сборка осуществляется через \texttt{CMakeLists.txt} с обязательной линковкой \texttt{-lpthread}.